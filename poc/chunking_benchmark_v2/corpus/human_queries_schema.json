{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Human-Like Query Ground Truth Schema",
  "description": "Schema for generating human-like query variations for RAG benchmark evaluation",
  "version": "1.0.0",
  
  "variation_dimensions": {
    "synonym": {
      "description": "Replace technical terms with synonyms or alternative phrasings",
      "purpose": "Tests vocabulary mismatch between user query and document terms",
      "examples": [
        {"original": "rate limit", "variations": ["throttling", "quota", "cap", "request cap"]},
        {"original": "authentication", "variations": ["login", "sign-in", "auth", "credentials"]},
        {"original": "database", "variations": ["DB", "data store", "storage"]},
        {"original": "timeout", "variations": ["time limit", "max wait time", "expiry"]}
      ],
      "guidelines": [
        "Use terms a developer might naturally use in conversation",
        "Include common abbreviations (DB, auth, config)",
        "Consider terms from different tech backgrounds (Java dev vs Python dev)"
      ]
    },
    "problem": {
      "description": "Describe the symptom or problem instead of asking for the solution directly",
      "purpose": "Tests intent understanding - user describes what's wrong, not what they need",
      "examples": [
        {"original": "What is the rate limit?", "variation": "my requests keep getting rejected with 429"},
        {"original": "How to fix OOM kills?", "variation": "my pods keep crashing and restarting"},
        {"original": "What's the token expiry?", "variation": "users complain they get logged out randomly"}
      ],
      "guidelines": [
        "Focus on observable symptoms",
        "Include error codes or messages when relevant",
        "Frame as 'something is broken' rather than 'how do I configure'"
      ]
    },
    "casual": {
      "description": "Informal, abbreviated queries like typing in Slack or quick search",
      "purpose": "Tests handling of terse, incomplete queries",
      "examples": [
        {"original": "What database does CloudFlow use?", "variation": "cloudflow db?"},
        {"original": "How do I configure SSO?", "variation": "sso setup"},
        {"original": "What is the API gateway timeout?", "variation": "gateway timeout config"}
      ],
      "guidelines": [
        "Remove unnecessary words (what, how, the, is)",
        "Use lowercase",
        "Keep to 2-5 words when possible",
        "Use common dev shorthand"
      ]
    },
    "contextual": {
      "description": "Frame the query within a real-world scenario or use case",
      "purpose": "Tests understanding of user intent within broader context",
      "examples": [
        {"original": "What is the rate limit?", "variation": "building a batch import job, need to know api limits"},
        {"original": "How to set up CI/CD?", "variation": "setting up github actions for our team, what's the cloudflow integration"},
        {"original": "What caching is used?", "variation": "trying to optimize response times, what caching options do we have"}
      ],
      "guidelines": [
        "Include a realistic use case or goal",
        "Mention the task the user is trying to accomplish",
        "Can be slightly longer than other variations"
      ]
    },
    "negation": {
      "description": "Frame as confusion, negation, or 'why is X happening'",
      "purpose": "Tests edge cases and inverse reasoning",
      "examples": [
        {"original": "What is the rate limit?", "variation": "why am I being blocked from the API"},
        {"original": "How long do tokens last?", "variation": "why does my token keep expiring"},
        {"original": "What encryption is used?", "variation": "is our data even encrypted?"}
      ],
      "guidelines": [
        "Use 'why' questions",
        "Frame as unexpected behavior",
        "Include doubt or verification requests",
        "Can express frustration naturally"
      ]
    }
  },

  "output_structure": {
    "type": "object",
    "properties": {
      "category": {
        "type": "string",
        "description": "The category this file contains (e.g., 'simple_lookup')"
      },
      "generated_at": {
        "type": "string",
        "format": "date-time"
      },
      "total_queries": {
        "type": "integer"
      },
      "total_variations": {
        "type": "integer"
      },
      "queries": {
        "type": "array",
        "items": {
          "$ref": "#/definitions/query_entry"
        }
      }
    }
  },

  "definitions": {
    "query_entry": {
      "type": "object",
      "required": ["id", "category", "original_query", "human_queries", "key_facts", "key_facts_semantic", "expected_docs", "ground_truth_answer", "metadata"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Original query ID from ground_truth_expanded.json"
        },
        "category": {
          "type": "string",
          "enum": ["simple_lookup", "cross_document", "how_to", "comparison", "troubleshooting", "architecture", "api_reference", "release_notes", "complex_multi_hop"]
        },
        "original_query": {
          "type": "string",
          "description": "The original mechanical/keyword-based query (preserved for comparison)"
        },
        "human_queries": {
          "type": "array",
          "minItems": 5,
          "maxItems": 5,
          "items": {
            "$ref": "#/definitions/human_query_variation"
          },
          "description": "Exactly 5 human-like query variations, one per dimension"
        },
        "key_facts": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Original exact-match key facts (preserved for baseline evaluation)"
        },
        "key_facts_semantic": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Semantic variations of key facts - alternative phrasings that mean the same thing"
        },
        "expected_docs": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Document IDs that should be retrieved (preserved from original)"
        },
        "ground_truth_answer": {
          "type": "string",
          "description": "The correct answer (preserved from original)"
        },
        "metadata": {
          "$ref": "#/definitions/query_metadata"
        }
      }
    },
    "human_query_variation": {
      "type": "object",
      "required": ["dimension", "query"],
      "properties": {
        "dimension": {
          "type": "string",
          "enum": ["synonym", "problem", "casual", "contextual", "negation"],
          "description": "Which variation dimension this query represents"
        },
        "query": {
          "type": "string",
          "description": "The human-like query variation"
        },
        "notes": {
          "type": "string",
          "description": "Optional: explanation of the transformation applied"
        }
      }
    },
    "query_metadata": {
      "type": "object",
      "required": ["concepts", "related_terms", "user_intent", "difficulty", "requires_inference"],
      "properties": {
        "concepts": {
          "type": "array",
          "items": {"type": "string"},
          "description": "High-level concepts this query relates to (for semantic grouping)"
        },
        "related_terms": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Terms that are semantically related - for query expansion experiments"
        },
        "user_intent": {
          "type": "string",
          "description": "The underlying user intent (e.g., 'understand_limits', 'debug_issue', 'configure_feature')"
        },
        "difficulty": {
          "type": "string",
          "enum": ["easy", "medium", "hard"],
          "description": "How difficult this query is to answer - easy=single doc, medium=cross-doc, hard=inference required"
        },
        "requires_inference": {
          "type": "boolean",
          "description": "Whether answering requires reasoning beyond direct text retrieval"
        },
        "domain": {
          "type": "string",
          "description": "Technical domain (e.g., 'database', 'security', 'devops', 'api')"
        }
      }
    }
  },

  "category_specific_guidance": {
    "simple_lookup": {
      "description": "Single fact lookups - direct answers from one location",
      "transformation_focus": "Heavy synonym variation, casual queries work well",
      "difficulty": "easy",
      "example_intents": ["find_config_value", "get_specific_fact", "lookup_setting"]
    },
    "cross_document": {
      "description": "Information spanning multiple documents",
      "transformation_focus": "Contextual and conceptual queries, 'how does X work across the system'",
      "difficulty": "medium",
      "example_intents": ["understand_system_behavior", "trace_data_flow", "see_full_picture"]
    },
    "how_to": {
      "description": "Procedural/instructional queries",
      "transformation_focus": "Problem-oriented ('I want to...'), goal-driven framing",
      "difficulty": "easy-medium",
      "example_intents": ["accomplish_task", "set_up_feature", "configure_integration"]
    },
    "comparison": {
      "description": "Comparing options or understanding tradeoffs",
      "transformation_focus": "Decision-making context, 'should I use X or Y', 'what's better'",
      "difficulty": "medium",
      "example_intents": ["make_decision", "understand_tradeoffs", "evaluate_options"]
    },
    "troubleshooting": {
      "description": "Debugging and problem resolution",
      "transformation_focus": "Problem and negation dimensions are key - describe symptoms",
      "difficulty": "medium-hard",
      "example_intents": ["fix_issue", "diagnose_problem", "resolve_error"]
    },
    "architecture": {
      "description": "System design and component understanding",
      "transformation_focus": "Conceptual questions, 'explain', 'how is X designed'",
      "difficulty": "medium",
      "example_intents": ["understand_design", "learn_architecture", "see_components"]
    },
    "api_reference": {
      "description": "API endpoints, parameters, usage",
      "transformation_focus": "Task-oriented ('I need to do X'), casual endpoint lookups",
      "difficulty": "easy",
      "example_intents": ["use_api", "find_endpoint", "understand_parameters"]
    },
    "release_notes": {
      "description": "Version history, changes, migrations",
      "transformation_focus": "Time-based ('when did'), version-specific, 'what changed'",
      "difficulty": "easy-medium",
      "example_intents": ["track_changes", "find_version_info", "understand_migration"]
    },
    "complex_multi_hop": {
      "description": "Requires synthesizing info from multiple sources with reasoning",
      "transformation_focus": "Scenario-based, compound questions, real-world framing",
      "difficulty": "hard",
      "example_intents": ["synthesize_information", "make_complex_decision", "understand_full_system"]
    }
  }
}
