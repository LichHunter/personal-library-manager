# Comprehensive Retrieval Benchmark Configuration
# ================================================
# This config defines the full combinatorial matrix:
# - 20 chunking strategies
# - 5 embedding models  
# - 6 retrieval strategies
# - 2 rerankers
# - 2 LLM models (for RAPTOR/LOD-LLM)
#
# Toggle `enabled: false` to disable specific combinations.
# Estimated runtime: ~2-4 hours with GPU

# =============================================================================
# CORPUS CONFIGURATION
# =============================================================================
corpus:
  # Path relative to benchmark directory
  documents_dir: "corpus/expanded_documents"
  metadata_file: "corpus/corpus_metadata_expanded.json"
  ground_truth_file: "corpus/ground_truth_expanded.json"

# =============================================================================
# EVALUATION SETTINGS
# =============================================================================
evaluation:
  k_values: [5, 10]
  metrics:
    - exact_match      # Exact substring match for key facts
    - fuzzy_match      # Word-level fuzzy match

# =============================================================================
# EMBEDDING MODELS
# =============================================================================
embedding_models:
  - name: "all-MiniLM-L6-v2"
    enabled: true
    use_prefix: false
    
  - name: "all-MiniLM-L12-v2"
    enabled: true
    use_prefix: false
    
  - name: "BAAI/bge-small-en-v1.5"
    enabled: true
    use_prefix: true  # BGE requires query prefix
    
  - name: "BAAI/bge-base-en-v1.5"
    enabled: true
    use_prefix: true
    
  - name: "thenlper/gte-small"
    enabled: true
    use_prefix: false

# =============================================================================
# RERANKER MODELS (for hybrid_rerank strategy)
# =============================================================================
reranker_models:
  - name: "cross-encoder/ms-marco-MiniLM-L-6-v2"
    enabled: true
    
  - name: "cross-encoder/ms-marco-MiniLM-L-12-v2"
    enabled: true

# =============================================================================
# LLM MODELS (for RAPTOR summarization and LOD-LLM routing)
# =============================================================================
llm_models:
  - name: "llama3.2:3b"
    enabled: true
    
  - name: "qwen2.5:3b"
    enabled: true
    
  - name: "phi3:3.8b"
    enabled: true
    
  - name: "llama3.2:7b"
    enabled: true
    
  - name: "qwen2.5:7b"
    enabled: true
    
  - name: "mistral:7b"
    enabled: true

# =============================================================================
# CHUNKING STRATEGIES
# =============================================================================
chunking_strategies:
  # --- Fixed Size Strategies (V2) ---
  - name: "fixed_512_0pct"
    type: "fixed_size"
    enabled: true
    params:
      chunk_size: 512
      overlap: 0
      
  - name: "fixed_512_15pct"
    type: "fixed_size"
    enabled: true
    params:
      chunk_size: 512
      overlap: 77  # 15% of 512
      
  - name: "fixed_400_0pct"
    type: "fixed_size"
    enabled: true
    params:
      chunk_size: 400
      overlap: 0
      
  - name: "fixed_300_0pct"
    type: "fixed_size"
    enabled: true
    params:
      chunk_size: 300
      overlap: 0
      
  - name: "fixed_200_0pct"
    type: "fixed_size"
    enabled: true
    params:
      chunk_size: 200
      overlap: 0

  # --- Recursive Splitter Strategies (V2) ---
  - name: "recursive_2000_0pct"
    type: "recursive_splitter"
    enabled: true
    params:
      chunk_size: 2000
      chunk_overlap: 0
      
  - name: "recursive_1600_0pct"
    type: "recursive_splitter"
    enabled: true
    params:
      chunk_size: 1600
      chunk_overlap: 0
      
  - name: "recursive_1600_15pct"
    type: "recursive_splitter"
    enabled: true
    params:
      chunk_size: 1600
      chunk_overlap: 240  # 15%
      
  - name: "recursive_1200_0pct"
    type: "recursive_splitter"
    enabled: true
    params:
      chunk_size: 1200
      chunk_overlap: 0
      
  - name: "recursive_800_0pct"
    type: "recursive_splitter"
    enabled: true
    params:
      chunk_size: 800
      chunk_overlap: 0

  # --- Semantic Clustering Strategies (V2) ---
  - name: "semantic_400"
    type: "cluster_semantic"
    enabled: true
    params:
      target_chunk_size: 400
      
  - name: "semantic_200"
    type: "cluster_semantic"
    enabled: true
    params:
      target_chunk_size: 200

  # --- V1 Strategies (Heading-based) ---
  - name: "heading_based_h3"
    type: "heading_based"
    enabled: true
    params:
      max_heading_level: 3
      
  - name: "heading_limited_512"
    type: "heading_limited"
    enabled: true
    params:
      max_heading_level: 3
      max_tokens: 512
      
  - name: "hierarchical_h4"
    type: "hierarchical"
    enabled: true
    params:
      max_heading_level: 4

  # --- V1 Strategies (Paragraph-based) ---
  - name: "heading_paragraph_h3"
    type: "heading_paragraph"
    enabled: true
    params:
      max_heading_level: 3
      
  - name: "paragraphs_50_256"
    type: "paragraphs"
    enabled: true
    params:
      min_tokens: 50
      max_tokens: 256
      
  - name: "paragraph_50_256"
    type: "paragraph_heading"
    enabled: true
    params:
      min_tokens: 50
      max_tokens: 256
      prepend_heading: false
      
  - name: "paragraph_50_256_heading"
    type: "paragraph_heading"
    enabled: true
    params:
      min_tokens: 50
      max_tokens: 256
      prepend_heading: true

  # --- V1 Fixed Size (for comparison) ---
  - name: "fixed_size_512_v1"
    type: "fixed_size"
    enabled: true
    params:
      chunk_size: 512
      overlap: 0

# =============================================================================
# RETRIEVAL STRATEGIES
# =============================================================================
retrieval_strategies:
  # --- Flat Strategies (work with any chunking) ---
  - name: "semantic"
    type: "semantic"
    enabled: true
    params: {}
    requires_embedder: true
    requires_reranker: false
    requires_llm: false
    requires_structured_docs: false
    
  - name: "hybrid"
    type: "hybrid"
    enabled: true
    params:
      rrf_k: 60
      candidate_multiplier: 10
    requires_embedder: true
    requires_reranker: false
    requires_llm: false
    requires_structured_docs: false
    
  - name: "hybrid_rerank"
    type: "hybrid_rerank"
    enabled: true
    params:
      rrf_k: 60
      candidate_multiplier: 4
    requires_embedder: true
    requires_reranker: true
    requires_llm: false
    requires_structured_docs: false

  # --- Hierarchical Strategies (use doc structure) ---
  - name: "lod"
    type: "lod"
    enabled: true
    params:
      chunk_size: 512
      doc_top_k: 3
      section_top_k: 5
    requires_embedder: true
    requires_reranker: false
    requires_llm: false
    requires_structured_docs: true
    
  - name: "lod_llm"
    type: "lod_llm"
    enabled: true
    params:
      chunk_size: 512
      doc_top_k: 3
      section_top_k: 5
    requires_embedder: true
    requires_reranker: false
    requires_llm: true
    requires_structured_docs: true
    
  - name: "raptor"
    type: "raptor"
    enabled: true
    params:
      max_layers: 2
      cluster_threshold: 0.1
      search_mode: "collapsed"
    requires_embedder: true
    requires_reranker: false
    requires_llm: true
    requires_structured_docs: false

# =============================================================================
# OUTPUT SETTINGS
# =============================================================================
output:
  results_dir: "results"
  save_detailed_results: true
  save_summary: true
  format: "json"  # json, csv, or both
