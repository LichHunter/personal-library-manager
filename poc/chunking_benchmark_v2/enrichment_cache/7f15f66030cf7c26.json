{"original_content": "**Technology**: Node.js with worker pool pattern **Replicas**: 8 pods (production), auto-scaling 6-16 **Resource Allocation**: 2 vCPU, 4GB RAM per pod **Key Responsibilities**: - Consume notification events from Kafka - Template rendering with Handlebars (cached in Redis) - Multi-channel delivery (Email via SendGrid, SMS via Twilio, Webhooks) - Retry logic with dead letter queue for failed deliveries - Delivery status tracking and analytics - User preference management (opt-in/opt-out) **Notification Flow**: ``` Event Source \u2192 Kafka (notifications.email topic) \u2502 \u25bc Notification Service Consumer \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u25bc \u25bc \u25bc [Email Queue] [SMS Queue] [Webhook Queue] \u2502 \u2502 \u2502 \u25bc \u25bc \u25bc [SendGrid] [Twilio] [HTTP POST] \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc Delivery Status \u2192 PostgreSQL ``` **Channel Configuration**: - Email: SendGrid with IP warming, DKIM/SPF configured - SMS: Twilio with fallback to AWS SNS - Webhook: Signed payloads (HMAC-SHA256), retry 3 times with exponential backoff - In-app: WebSocket connections via Socket.io **Template Management**: - Templates stored in PostgreSQL with versioning - Compiled templates cached in Redis (1-hour TTL) - Support for localization (i18n) with 12 languages - A/B testing capability for email campaigns **Performance Targets**: - Email delivery: < 5 seconds (P99) from event to SendGrid - SMS delivery: < 3 seconds (P99) - Throughput: 10,000 notifications per minute --- ## Data Flow Architecture ### Synchronous Request Flow Client requests follow a synchronous path through the API Gateway to backend services: ``` 1. Client \u2192 Load Balancer (TLS termination) 2. Load Balancer \u2192 API Gateway (HTTP/2) 3. API Gateway \u2192 Auth Service (JWT validation via gRPC) 4. API Gateway \u2192 Target Service (HTTP/REST or gRPC) 5. Target Service \u2192 Database/Cache (data retrieval) 6. Response propagates back through the chain ``` **Timeout Configuration**: - Client \u2192 Load Balancer: 60 seconds - Load Balancer \u2192 API Gateway: 55 seconds - API Gateway \u2192 Services: 45 seconds - Service \u2192 Database: 10 seconds ### Asynchronous Event Flow Long-running operations and inter-service communication use event-driven patterns: ``` 1. Service publishes event \u2192 Kafka topic 2. Kafka persists event (replication factor: 3) 3. Consumer groups subscribe to topics 4. Consumers process events with at-least-once delivery 5. State updates written to PostgreSQL 6.", "enhanced_content": "SMS Queue, Webhook Queue, Email Queue, Resource Allocation, Key Responsibilities, Compiled templates, AWS SNS | Consume, Handlebars, Kafka - Template, SMS, Redis\n\n**Technology**: Node.js with worker pool pattern **Replicas**: 8 pods (production), auto-scaling 6-16 **Resource Allocation**: 2 vCPU, 4GB RAM per pod **Key Responsibilities**: - Consume notification events from Kafka - Template rendering with Handlebars (cached in Redis) - Multi-channel delivery (Email via SendGrid, SMS via Twilio, Webhooks) - Retry logic with dead letter queue for failed deliveries - Delivery status tracking and analytics - User preference management (opt-in/opt-out) **Notification Flow**: ``` Event Source \u2192 Kafka (notifications.email topic) \u2502 \u25bc Notification Service Consumer \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u25bc \u25bc \u25bc [Email Queue] [SMS Queue] [Webhook Queue] \u2502 \u2502 \u2502 \u25bc \u25bc \u25bc [SendGrid] [Twilio] [HTTP POST] \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc Delivery Status \u2192 PostgreSQL ``` **Channel Configuration**: - Email: SendGrid with IP warming, DKIM/SPF configured - SMS: Twilio with fallback to AWS SNS - Webhook: Signed payloads (HMAC-SHA256), retry 3 times with exponential backoff - In-app: WebSocket connections via Socket.io **Template Management**: - Templates stored in PostgreSQL with versioning - Compiled templates cached in Redis (1-hour TTL) - Support for localization (i18n) with 12 languages - A/B testing capability for email campaigns **Performance Targets**: - Email delivery: < 5 seconds (P99) from event to SendGrid - SMS delivery: < 3 seconds (P99) - Throughput: 10,000 notifications per minute --- ## Data Flow Architecture ### Synchronous Request Flow Client requests follow a synchronous path through the API Gateway to backend services: ``` 1. Client \u2192 Load Balancer (TLS termination) 2. Load Balancer \u2192 API Gateway (HTTP/2) 3. API Gateway \u2192 Auth Service (JWT validation via gRPC) 4. API Gateway \u2192 Target Service (HTTP/REST or gRPC) 5. Target Service \u2192 Database/Cache (data retrieval) 6. Response propagates back through the chain ``` **Timeout Configuration**: - Client \u2192 Load Balancer: 60 seconds - Load Balancer \u2192 API Gateway: 55 seconds - API Gateway \u2192 Services: 45 seconds - Service \u2192 Database: 10 seconds ### Asynchronous Event Flow Long-running operations and inter-service communication use event-driven patterns: ``` 1. Service publishes event \u2192 Kafka topic 2. Kafka persists event (replication factor: 3) 3. Consumer groups subscribe to topics 4. Consumers process events with at-least-once delivery 5. State updates written to PostgreSQL 6.", "enrichment_type": "fast", "metadata": {"code_ratio": 0.25, "processing_time_ms": 85.21, "keyword_count": 10, "entity_count": 15}, "keywords": ["SMS Queue", "Webhook Queue", "Email Queue", "Resource Allocation", "Key Responsibilities", "Compiled templates", "AWS SNS", "Template Management", "Load Balancer", "Consume notification"], "questions": [], "summary": "", "entities": {"PERSON": ["Consume", "Handlebars", "Email", "Kafka", "Email Queue"], "ORG": ["Kafka - Template", "SMS", "Twilio,", "Webhooks) -", "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500"], "GPE": ["Redis", "PostgreSQL", "SendGrid"], "FAC": ["Socket.io *", "the API Gateway"]}, "contextual_prefix": ""}