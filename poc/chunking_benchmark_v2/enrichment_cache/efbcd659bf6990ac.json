{"original_content": "**Verify Service Health**: ```bash kubectl get pods -n cloudflow-prod curl https://api.cloudflow.io/health ``` **Recovery Time Objective (RTO)**: 4 hours **Recovery Point Objective (RPO)**: 24 hours --- ## Scaling and Performance ### Horizontal Pod Autoscaling CloudFlow is configured with Horizontal Pod Autoscaler (HPA) to automatically scale based on resource utilization: ```yaml # hpa.yaml apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata: name: cloudflow-api-hpa namespace: cloudflow-prod spec: scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: cloudflow-api minReplicas: 3 maxReplicas: 10 metrics: - type: Resource resource: name: cpu target: type: Utilization averageUtilization: 70 - type: Resource resource: name: memory target: type: Utilization averageUtilization: 80 behavior: scaleDown: stabilizationWindowSeconds: 300 policies: - type: Percent value: 50 periodSeconds: 60 scaleUp: stabilizationWindowSeconds: 60 policies: - type: Percent value: 100 periodSeconds: 30 - type: Pods value: 2 periodSeconds: 30 selectPolicy: Max ``` Monitor autoscaling events: ```bash kubectl get hpa -n cloudflow-prod -w kubectl describe hpa cloudflow-api-hpa -n cloudflow-prod ``` ### Performance Optimization #### Connection Pooling Ensure optimal database connection pooling settings in PgBouncer: - **Pool Mode**: Transaction (optimal for microservices) - **Default Pool Size**: 25 connections per user - **Max DB Connections**: 100 (matches PostgreSQL `max_connections`) #### Redis Caching Implement Redis caching for frequently accessed data: ```javascript // Example caching strategy const CACHE_TTL = { workflows: 300, // 5 minutes userSessions: 3600, // 1 hour apiResults: 60 // 1 minute }; ``` #### Load Testing Perform regular load testing to validate scaling configuration: ```bash # Install k6 for load testing kubectl apply -f - <<EOF apiVersion: v1 kind: ConfigMap metadata: name: loadtest-script namespace: cloudflow-prod data: script.js: | import http from 'k6/http'; import { check, sleep } from 'k6'; export let options = { stages: [ { duration: '2m', target: 100 }, { duration: '5m', target: 100 }, { duration: '2m', target: 200 }, { duration: '5m', target: 200 }, { duration: '2m', target: 0 }, ], thresholds: { http_req_duration: ['p(95)<500'], }, }; export default function () { let res = http.get('https://api.cloudflow.io/api/workflows'); check(res, { 'status is 200': (r) => r.status === 200 }); sleep(1); } EOF ``` **Performance Targets**: - P95 API latency: < 500ms - P99 API latency: < 1000ms - Error rate: < 0.1% - Throughput: > 1000 requests/second --- ## Security and Compliance ### Network Policies Implement network policies to restrict pod-to-pod communication: ```yaml # network-policy.yaml apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: cloudflow-network-policy namespace: cloudflow-prod spec:", "enhanced_content": "API latency, Horizontal Pod, Redis Caching, Pod Autoscaler, Verify Service, Service Health, Recovery Time | RTO, RPO, PgBouncer, Redis Caching\n\n**Verify Service Health**: ```bash kubectl get pods -n cloudflow-prod curl https://api.cloudflow.io/health ``` **Recovery Time Objective (RTO)**: 4 hours **Recovery Point Objective (RPO)**: 24 hours --- ## Scaling and Performance ### Horizontal Pod Autoscaling CloudFlow is configured with Horizontal Pod Autoscaler (HPA) to automatically scale based on resource utilization: ```yaml # hpa.yaml apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata: name: cloudflow-api-hpa namespace: cloudflow-prod spec: scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: cloudflow-api minReplicas: 3 maxReplicas: 10 metrics: - type: Resource resource: name: cpu target: type: Utilization averageUtilization: 70 - type: Resource resource: name: memory target: type: Utilization averageUtilization: 80 behavior: scaleDown: stabilizationWindowSeconds: 300 policies: - type: Percent value: 50 periodSeconds: 60 scaleUp: stabilizationWindowSeconds: 60 policies: - type: Percent value: 100 periodSeconds: 30 - type: Pods value: 2 periodSeconds: 30 selectPolicy: Max ``` Monitor autoscaling events: ```bash kubectl get hpa -n cloudflow-prod -w kubectl describe hpa cloudflow-api-hpa -n cloudflow-prod ``` ### Performance Optimization #### Connection Pooling Ensure optimal database connection pooling settings in PgBouncer: - **Pool Mode**: Transaction (optimal for microservices) - **Default Pool Size**: 25 connections per user - **Max DB Connections**: 100 (matches PostgreSQL `max_connections`) #### Redis Caching Implement Redis caching for frequently accessed data: ```javascript // Example caching strategy const CACHE_TTL = { workflows: 300, // 5 minutes userSessions: 3600, // 1 hour apiResults: 60 // 1 minute }; ``` #### Load Testing Perform regular load testing to validate scaling configuration: ```bash # Install k6 for load testing kubectl apply -f - <<EOF apiVersion: v1 kind: ConfigMap metadata: name: loadtest-script namespace: cloudflow-prod data: script.js: | import http from 'k6/http'; import { check, sleep } from 'k6'; export let options = { stages: [ { duration: '2m', target: 100 }, { duration: '5m', target: 100 }, { duration: '2m', target: 200 }, { duration: '5m', target: 200 }, { duration: '2m', target: 0 }, ], thresholds: { http_req_duration: ['p(95)<500'], }, }; export default function () { let res = http.get('https://api.cloudflow.io/api/workflows'); check(res, { 'status is 200': (r) => r.status === 200 }); sleep(1); } EOF ``` **Performance Targets**: - P95 API latency: < 500ms - P99 API latency: < 1000ms - Error rate: < 0.1% - Throughput: > 1000 requests/second --- ## Security and Compliance ### Network Policies Implement network policies to restrict pod-to-pod communication: ```yaml # network-policy.yaml apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: cloudflow-network-policy namespace: cloudflow-prod spec:", "enrichment_type": "fast", "metadata": {"code_ratio": 0.59, "processing_time_ms": 41.31, "keyword_count": 10, "entity_count": 7}, "keywords": ["API latency", "Horizontal Pod", "Redis Caching", "Pod Autoscaler", "Verify Service", "Service Health", "Recovery Time", "Time Objective", "Recovery Point", "Point Objective"], "questions": [], "summary": "", "entities": {"ORG": ["RTO", "RPO", "Horizontal Pod Autoscaling", "Horizontal Pod Autoscaler", "HPA"], "GPE": ["PgBouncer"], "PERSON": ["Redis Caching"]}, "contextual_prefix": ""}