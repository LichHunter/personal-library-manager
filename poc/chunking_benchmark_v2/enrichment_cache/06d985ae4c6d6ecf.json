{"original_content": "Review Query Execution Plans** ```sql -- Connect to CloudFlow database cloudflow db connect --readonly -- Explain slow query EXPLAIN ANALYZE SELECT w.*, e.status, e.error_message FROM workflows w LEFT JOIN executions e ON w.id = e.workflow_id WHERE w.workspace_id = 'ws_abc123' AND e.created_at > NOW() - INTERVAL '7 days' ORDER BY e.created_at DESC; -- Check for missing indexes SELECT schemaname, tablename, indexname, indexdef FROM pg_indexes WHERE tablename IN ('workflows', 'executions', 'workflow_steps') ORDER BY tablename, indexname; ``` **3. Optimize Queries** Common optimization techniques: **Add missing indexes:** ```sql -- Index for workflow lookup by workspace CREATE INDEX CONCURRENTLY idx_workflows_workspace_created ON workflows(workspace_id, created_at DESC); -- Index for execution status queries CREATE INDEX CONCURRENTLY idx_executions_status_created ON executions(workflow_id, status, created_at DESC) WHERE status IN ('running', 'pending'); -- Composite index for common filter combinations CREATE INDEX CONCURRENTLY idx_executions_workspace_status ON executions(workspace_id, status, created_at) INCLUDE (error_message, retry_count); ``` **Use query result caching:** ```bash # Enable query cache for workspace metadata cloudflow config set cache.workspace.ttl 3600 # Configure Redis cache backend cloudflow config set cache.backend redis cloudflow config set cache.redis.host redis.cloudflow.svc.cluster.local cloudflow config set cache.redis.port 6379 ``` ### High API Latency #### Latency Breakdown Analysis ```bash # Generate latency report cloudflow metrics latency-report --endpoint \"/api/v1/workflows\" --last 24h # Sample output: # Endpoint: POST /api/v1/workflows/execute # P50: 245ms | P95: 1823ms | P99: 4521ms # Breakdown: # - Auth: 45ms (18%) # - DB Query: 156ms (64%) # - Business Logic: 32ms (13%) # - Response Serialization: 12ms (5%) ``` **Network latency issues:** ```bash # Test connectivity to CloudFlow API time curl -w \"@curl-format.txt\" -o /dev/null -s https://api.cloudflow.io/health # Create curl-format.txt: cat > curl-format.txt << EOF time_namelookup: %{time_namelookup}s\\n time_connect: %{time_connect}s\\n time_appconnect: %{time_appconnect}s\\n time_pretransfer: %{time_pretransfer}s\\n time_redirect: %{time_redirect}s\\n time_starttransfer: %{time_starttransfer}s\\n ----------\\n time_total: %{time_total}s\\n EOF # Trace route to API endpoint traceroute api.cloudflow.io # Check DNS resolution time dig api.cloudflow.io | grep \"Query time\" ``` ### Memory Leaks #### Detection ```bash # Monitor CloudFlow service memory usage kubectl top pods -n cloudflow --sort-by=memory # Get detailed memory metrics for specific pod kubectl exec -n cloudflow deploy/cloudflow-api -- \\ curl localhost:9090/metrics | grep memory # Check for OOMKilled pods kubectl get pods -n cloudflow --field-selector=status.phase=Failed | \\ grep OOMKilled # Review memory limits and requests kubectl describe deployment cloudflow-api -n cloudflow | \\ grep -A 5 \"Limits\\|Requests\" ``` #### Common Causes **1.", "enhanced_content": "Execution Plans, Query Execution, Review Query, Memory Leaks, High API, Breakdown Analysis, Plans | API\n\nReview Query Execution Plans** ```sql -- Connect to CloudFlow database cloudflow db connect --readonly -- Explain slow query EXPLAIN ANALYZE SELECT w.*, e.status, e.error_message FROM workflows w LEFT JOIN executions e ON w.id = e.workflow_id WHERE w.workspace_id = 'ws_abc123' AND e.created_at > NOW() - INTERVAL '7 days' ORDER BY e.created_at DESC; -- Check for missing indexes SELECT schemaname, tablename, indexname, indexdef FROM pg_indexes WHERE tablename IN ('workflows', 'executions', 'workflow_steps') ORDER BY tablename, indexname; ``` **3. Optimize Queries** Common optimization techniques: **Add missing indexes:** ```sql -- Index for workflow lookup by workspace CREATE INDEX CONCURRENTLY idx_workflows_workspace_created ON workflows(workspace_id, created_at DESC); -- Index for execution status queries CREATE INDEX CONCURRENTLY idx_executions_status_created ON executions(workflow_id, status, created_at DESC) WHERE status IN ('running', 'pending'); -- Composite index for common filter combinations CREATE INDEX CONCURRENTLY idx_executions_workspace_status ON executions(workspace_id, status, created_at) INCLUDE (error_message, retry_count); ``` **Use query result caching:** ```bash # Enable query cache for workspace metadata cloudflow config set cache.workspace.ttl 3600 # Configure Redis cache backend cloudflow config set cache.backend redis cloudflow config set cache.redis.host redis.cloudflow.svc.cluster.local cloudflow config set cache.redis.port 6379 ``` ### High API Latency #### Latency Breakdown Analysis ```bash # Generate latency report cloudflow metrics latency-report --endpoint \"/api/v1/workflows\" --last 24h # Sample output: # Endpoint: POST /api/v1/workflows/execute # P50: 245ms | P95: 1823ms | P99: 4521ms # Breakdown: # - Auth: 45ms (18%) # - DB Query: 156ms (64%) # - Business Logic: 32ms (13%) # - Response Serialization: 12ms (5%) ``` **Network latency issues:** ```bash # Test connectivity to CloudFlow API time curl -w \"@curl-format.txt\" -o /dev/null -s https://api.cloudflow.io/health # Create curl-format.txt: cat > curl-format.txt << EOF time_namelookup: %{time_namelookup}s\\n time_connect: %{time_connect}s\\n time_appconnect: %{time_appconnect}s\\n time_pretransfer: %{time_pretransfer}s\\n time_redirect: %{time_redirect}s\\n time_starttransfer: %{time_starttransfer}s\\n ----------\\n time_total: %{time_total}s\\n EOF # Trace route to API endpoint traceroute api.cloudflow.io # Check DNS resolution time dig api.cloudflow.io | grep \"Query time\" ``` ### Memory Leaks #### Detection ```bash # Monitor CloudFlow service memory usage kubectl top pods -n cloudflow --sort-by=memory # Get detailed memory metrics for specific pod kubectl exec -n cloudflow deploy/cloudflow-api -- \\ curl localhost:9090/metrics | grep memory # Check for OOMKilled pods kubectl get pods -n cloudflow --field-selector=status.phase=Failed | \\ grep OOMKilled # Review memory limits and requests kubectl describe deployment cloudflow-api -n cloudflow | \\ grep -A 5 \"Limits\\|Requests\" ``` #### Common Causes **1.", "enrichment_type": "fast", "metadata": {"code_ratio": 0.91, "processing_time_ms": 19.15, "keyword_count": 10, "entity_count": 1}, "keywords": ["Execution Plans", "Query Execution", "Review Query", "Memory Leaks", "High API", "Breakdown Analysis", "Plans", "Optimize Queries", "Network latency", "Execution"], "questions": [], "summary": "", "entities": {"ORG": ["API"]}, "contextual_prefix": ""}