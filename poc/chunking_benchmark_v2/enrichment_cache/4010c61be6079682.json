{"original_content": "create cluster -f cluster-config.yaml ``` ### Storage Configuration Install the EBS CSI driver for persistent volumes: ```bash eksctl create addon --name aws-ebs-csi-driver \\ --cluster cloudflow-production \\ --service-account-role-arn arn:aws:iam::ACCOUNT_ID:role/AmazonEKS_EBS_CSI_DriverRole \\ --force ``` --- ## Kubernetes Deployment ### Namespace Setup Create the CloudFlow namespace and configure resource quotas: ```yaml # namespace.yaml apiVersion: v1 kind: Namespace metadata: name: cloudflow-prod labels: name: cloudflow-prod environment: production --- apiVersion: v1 kind: ResourceQuota metadata: name: cloudflow-quota namespace: cloudflow-prod spec: hard: requests.cpu: \"50\" requests.memory: 100Gi persistentvolumeclaims: \"10\" services.loadbalancers: \"2\" ``` Apply the namespace configuration: ```bash kubectl apply -f namespace.yaml ``` ### Environment Configuration CloudFlow requires the following environment variables: | Variable | Description | Example | Required | |----------|-------------|---------|----------| | `DATABASE_URL` | PostgreSQL connection string | `postgresql://user:pass@host:5432/cloudflow` | Yes | | `REDIS_URL` | Redis connection string | `redis://redis-master.cloudflow-prod.svc.cluster.local:6379` | Yes | | `JWT_SECRET` | Secret key for JWT token signing | `<generated-secret-256-bit>` | Yes | | `LOG_LEVEL` | Application log verbosity | `info`, `debug`, `warn`, `error` | No (default: `info`) | | `API_PORT` | API server port | `3000` | No (default: `3000`) | | `WORKER_CONCURRENCY` | Number of concurrent workers | `10` | No (default: `5`) | | `SESSION_SECRET` | Session encryption key | `<generated-secret-256-bit>` | Yes | | `AWS_REGION` | AWS region for services | `us-east-1` | Yes | | `S3_BUCKET` | S3 bucket for file storage | `cloudflow-prod-storage` | Yes | | `SMTP_HOST` | Email server hostname | `smtp.sendgrid.net` | No | | `SMTP_PORT` | Email server port | `587` | No | | `METRICS_ENABLED` | Enable Prometheus metrics | `true` | No (default: `false`) | Create a Kubernetes secret for sensitive variables: ```bash kubectl create secret generic cloudflow-secrets \\ --namespace cloudflow-prod \\ --from-literal=DATABASE_URL=\"postgresql://cloudflow:$(cat db-password.txt)@pgbouncer.cloudflow-prod.svc.cluster.local:5432/cloudflow\" \\ --from-literal=REDIS_URL=\"redis://redis-master.cloudflow-prod.svc.cluster.local:6379\" \\ --from-literal=JWT_SECRET=\"$(openssl rand -base64 32)\" \\ --from-literal=SESSION_SECRET=\"$(openssl rand -base64 32)\" ``` ### Helm Chart Deployment Add the CloudFlow Helm repository: ```bash helm repo add cloudflow https://charts.cloudflow.io helm repo update ``` Create a values file for production configuration: ```yaml # values-production.yaml replicaCount: 3 image: repository: 123456789012.dkr.ecr.us-east-1.amazonaws.com/cloudflow tag: \"2.4.0\" pullPolicy: IfNotPresent resources: limits: cpu: 2000m memory: 4Gi requests: cpu: 2000m memory: 4Gi autoscaling: enabled: true minReplicas: 3 maxReplicas: 10 targetCPUUtilizationPercentage: 70 targetMemoryUtilizationPercentage: 80 service: type: ClusterIP port: 80 targetPort: 3000 annotations: service.beta.kubernetes.io/aws-load-balancer-type: \"nlb\" ingress: enabled: true className: nginx annotations: cert-manager.io/cluster-issuer: \"letsencrypt-prod\" nginx.ingress.kubernetes.io/ssl-redirect: \"true\" hosts: - host: api.cloudflow.io paths: - path: / pathType: Prefix tls:", "enhanced_content": "openssl rand, Prefix tls, from-literal, IfNotPresent resources, ClusterIP port, helm repo, force yaml | addon, Namespace, metadata, ResourceQuota, bash helm repo\n\ncreate cluster -f cluster-config.yaml ``` ### Storage Configuration Install the EBS CSI driver for persistent volumes: ```bash eksctl create addon --name aws-ebs-csi-driver \\ --cluster cloudflow-production \\ --service-account-role-arn arn:aws:iam::ACCOUNT_ID:role/AmazonEKS_EBS_CSI_DriverRole \\ --force ``` --- ## Kubernetes Deployment ### Namespace Setup Create the CloudFlow namespace and configure resource quotas: ```yaml # namespace.yaml apiVersion: v1 kind: Namespace metadata: name: cloudflow-prod labels: name: cloudflow-prod environment: production --- apiVersion: v1 kind: ResourceQuota metadata: name: cloudflow-quota namespace: cloudflow-prod spec: hard: requests.cpu: \"50\" requests.memory: 100Gi persistentvolumeclaims: \"10\" services.loadbalancers: \"2\" ``` Apply the namespace configuration: ```bash kubectl apply -f namespace.yaml ``` ### Environment Configuration CloudFlow requires the following environment variables: | Variable | Description | Example | Required | |----------|-------------|---------|----------| | `DATABASE_URL` | PostgreSQL connection string | `postgresql://user:pass@host:5432/cloudflow` | Yes | | `REDIS_URL` | Redis connection string | `redis://redis-master.cloudflow-prod.svc.cluster.local:6379` | Yes | | `JWT_SECRET` | Secret key for JWT token signing | `<generated-secret-256-bit>` | Yes | | `LOG_LEVEL` | Application log verbosity | `info`, `debug`, `warn`, `error` | No (default: `info`) | | `API_PORT` | API server port | `3000` | No (default: `3000`) | | `WORKER_CONCURRENCY` | Number of concurrent workers | `10` | No (default: `5`) | | `SESSION_SECRET` | Session encryption key | `<generated-secret-256-bit>` | Yes | | `AWS_REGION` | AWS region for services | `us-east-1` | Yes | | `S3_BUCKET` | S3 bucket for file storage | `cloudflow-prod-storage` | Yes | | `SMTP_HOST` | Email server hostname | `smtp.sendgrid.net` | No | | `SMTP_PORT` | Email server port | `587` | No | | `METRICS_ENABLED` | Enable Prometheus metrics | `true` | No (default: `false`) | Create a Kubernetes secret for sensitive variables: ```bash kubectl create secret generic cloudflow-secrets \\ --namespace cloudflow-prod \\ --from-literal=DATABASE_URL=\"postgresql://cloudflow:$(cat db-password.txt)@pgbouncer.cloudflow-prod.svc.cluster.local:5432/cloudflow\" \\ --from-literal=REDIS_URL=\"redis://redis-master.cloudflow-prod.svc.cluster.local:6379\" \\ --from-literal=JWT_SECRET=\"$(openssl rand -base64 32)\" \\ --from-literal=SESSION_SECRET=\"$(openssl rand -base64 32)\" ``` ### Helm Chart Deployment Add the CloudFlow Helm repository: ```bash helm repo add cloudflow https://charts.cloudflow.io helm repo update ``` Create a values file for production configuration: ```yaml # values-production.yaml replicaCount: 3 image: repository: 123456789012.dkr.ecr.us-east-1.amazonaws.com/cloudflow tag: \"2.4.0\" pullPolicy: IfNotPresent resources: limits: cpu: 2000m memory: 4Gi requests: cpu: 2000m memory: 4Gi autoscaling: enabled: true minReplicas: 3 maxReplicas: 10 targetCPUUtilizationPercentage: 70 targetMemoryUtilizationPercentage: 80 service: type: ClusterIP port: 80 targetPort: 3000 annotations: service.beta.kubernetes.io/aws-load-balancer-type: \"nlb\" ingress: enabled: true className: nginx annotations: cert-manager.io/cluster-issuer: \"letsencrypt-prod\" nginx.ingress.kubernetes.io/ssl-redirect: \"true\" hosts: - host: api.cloudflow.io paths: - path: / pathType: Prefix tls:", "enrichment_type": "fast", "metadata": {"code_ratio": 0.47, "processing_time_ms": 47.34, "keyword_count": 10, "entity_count": 10}, "keywords": ["openssl rand", "Prefix tls", "from-literal", "IfNotPresent resources", "ClusterIP port", "helm repo", "force yaml", "ResourceQuota metadata", "nginx annotations", "true minReplicas"], "questions": [], "summary": "", "entities": {"GPE": ["addon"], "PERSON": ["Namespace", "metadata", "helm repo"], "ORG": ["ResourceQuota", "bash helm repo", "minReplicas", "api.cloudflow.io"], "NORP": ["ClusterIP"], "WORK_OF_ART": ["letsencrypt-prod"]}, "contextual_prefix": ""}